# Implementing OSPF

## Link-State Routing Protocol Overview
Link-state routing protocols such as OSPF have several advantages when compared to distance vector routing protocols:
  * Link-state protocols are more scalable
  * Each router has a full picture of a topology
  * Updates are sent when a topology change occurs and are reflooded periodically
  * Link-state protocols respond quickly to topology changes
  * More information is communicated between routers

## Link-State Routing Protocol Data Structures
A router that is running a link-state routing protocol must first recognize other routers and establish a neighbor adjacency with its neighboring routers. A router achieves this neighbor adjacency by exchanging hello packets with neighboring routers. After a router establishes a neighbor adjacency by using the hello packets, a neighbor is put into the neighbor database.

## Introducing OSPF
  * Developed by the IETF
  * Creates a neighbor relationship by exchanging hello packets
  * Propagates LSAs rather than routing table updates
    - Link: Router interface
    - State: Description of an interface and its relationship to neighboring routers
  * Floods LSAs to all OSPF routers in the area, not just directly connected routers
  * Pieces together all of the LSAs that are generated by the OSPF routers to create the OSPF link-state database
  * Uses the SPF algorithm to calculate the shortest path to each destination and places it in the routing table

Shortest Path First (SPF) algorithm was created by Edsger Dijsktra

## SPF Algorithm
  * OSPF uses a path cost as a metric
  * By default, cost is calculated based on interface bandwidth
  * Cost = Reference bandwidth / interface bandwidth, where reference bandwidth is 100 Mb/s

The SPF algorithm places each router at the root of a tree and calculates the shortest path to each node, using Dijkstra's algorithm. Dijkstra's algorithm is baed on the cumulative cost to reach this destination.

A metric is an indication of the overhead that is required to send packets across a certain interface. OSPF uses cost as a metric. A lower cost indicates a better path than a higher cost. The cost of an interface is inversely proportional to the bandwidth of the interface, so a higher bandwith indicates a lower cost. More overhead, higher cost, and more time delays are involved in corssing a 10-Mb/s Ethernet line than in corssing a 100 -Mb/s Ethernet line.

## Buildign a Link-State Database
Foure types of update packets are used when building a synchronizing LSDBs:
  * DBD packet
  * LSR packet
  * LSU packet
  * LSU packet
  * LASck packet

## OSPF Area Structure
Characteristics of transit areas and regular areas
  * OSPF supports hierarchical network structure
  * The two-level hierarchy consists of the following
    - Backbone area (Area 0)
    - Normal areas

In small networks, the web of router links is not complex, and paths to individual destinations are easily deduced. However, in large netowrks, the web is highly complex, and the number of potential pathsto aech destination is large. Therefore, the Dijkstra calculations that are comparing all of these possible routes can be very complex and can take a significant amount of time to complete

In general, to maximize stablilty, one router should not be in more than three area
  * Backbone routers
  * Internal routers
  * ABRs
  * ASBRs

An ABR has the following characteristics:
  * It separates LSA flooding zones
  * It becomes the primary point for area address summarization
  * It functions regularly as the source for default routes
  * It maintains the LSDB for each area with which it is connected

The ASBR is the point where external routes can be introduced into OSPF AS

| LSA Type | Description |
| --- | --- |
| 1 | Router LSA |
| 2 | Network LSA |
| 3 | Summary LSA |
| 4 | ASBR summary LSA |
| 5 | Automomous system LSA |

There are many types of LSAs, such as these basic types
**Type 1:** Every router generates router link advertisements for each area to which it belongs. Router link advertisements describe the state of the router links to the area and are flooded only within this particular area
**Type 2:** Generated by the DR, these are flooded in the area that contains the network
**Type 3:** An ABR takes the information that is learned in one area and summarizes it for another area. This summarization is not on be default. This summarization means smaller routing tables of OSPF router
**Type 4:** This informs the rest of the OSPF domain how to get to the ASBR
**Type 5:** External link advertisements that are generated by the ASBRs. They get flooded everywhere except into special areas

## Router ID
  * The number by which the router is know to OSPF can be set manually using the `router-id` command
  * If `router-id` is not configured, the highest IP address on the active loopback interface at the moment of OSPF process startup is selected as teh router ID
  * If there is no active loopback interfacem then the rotuer selects the highest IP address on the active interface at the moment in of OSPF process startup
